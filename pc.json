[{"spelEvaluator":"v2","lastModifiedBy":"rsomasunderam@netflix.com","index":0,"description":"Builds nightly or when the cisys/nflx-jenkins package changes in stash.  Always builds the latest Jenkins LTS version.","triggers":[{"enabled":true,"job":"CISYS-nflx-jenkins","master":"opseng","type":"jenkins"}],"executionEngine":"v3","stageCounter":4,"appConfig":{},"limitConcurrent":true,"application":"jenkins","parallel":true,"name":"controller-hydrogen-scm-nightly","stages":[{"baseLabel":"release","baseOs":"xenial","cloudProviderType":"aws","extendedAttributes":{},"name":"Bake","notifications":[{"address":"jenkins-admin","level":"stage","type":"slack","when":["stage.failed"]}],"package":"nflx-jenkins","refId":"1","regions":["us-west-2"],"requisiteStageRefIds":[],"sendNotifications":true,"showAdvancedOptions":false,"storeType":"ebs","type":"bake","user":"kvick@netflix.com","vmType":"hvm"},{"clusters":[{"account":"build_prod","application":"jenkins","availabilityZones":{"us-west-2":["us-west-2a","us-west-2b","us-west-2c"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":true,"ebsOptimized":true,"enabledMetrics":[],"freeFormDetails":"","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"BaseIAMRole","instanceMonitoring":false,"instanceType":"m5.xlarge","keyPair":"nf-keypair-453078116140-us-west-2","legacyUdf":false,"loadBalancers":["jenkins-hydrogen-frontend"],"moniker":{"app":"jenkins","detail":"","stack":"hydrogen"},"provider":"aws","securityGroups":["sg-c9fff0b7","sg-a9e2f2d7"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"hydrogen","strategy":"","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy","refId":"2","requisiteStageRefIds":["3"],"type":"deploy"},{"action":"scale_exact","capacity":{"desired":0,"max":0,"min":0},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-hydrogen","credentials":"build_prod","name":"Resize Server Group","refId":"3","regions":["us-west-2"],"requisiteStageRefIds":["1"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-hydrogen","completeOtherBranchesThenFail":false,"continuePipeline":false,"credentials":"build_prod","failPipeline":false,"name":"Destroy previous hydrogen master","refId":"4","regions":["us-west-2"],"requisiteStageRefIds":["2"],"target":"ancestor_asg_dynamic","type":"destroyServerGroup"},{"action":"scale_exact","capacity":{"desired":0,"max":0,"min":0},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-hydrogen-slave","completeOtherBranchesThenFail":false,"continuePipeline":true,"credentials":"build_prod","failPipeline":false,"moniker":{"app":"jenkins","cluster":"jenkins-hydrogen-slave","detail":"slave","stack":"hydrogen"},"name":"Terminate all hydrogen slaves","refId":"5","regions":["us-west-2"],"requisiteStageRefIds":["2"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"action":"scale_exact","capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-hydrogen-slave","credentials":"build_prod","moniker":{"app":"jenkins","cluster":"jenkins-hydrogen-slave","detail":"slave","stack":"hydrogen"},"name":"Create new hydrogen slaves","refId":"6","regions":["us-west-2"],"requisiteStageRefIds":["5"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"ROCK-jenkins-auth-acceptance-tests","master":"opseng","name":"Run auth tests","parameters":{"CONTROLLERS":"hydrogen"},"refId":"7","requisiteStageRefIds":["6"],"type":"jenkins"}],"id":"82d09e16-5810-407f-9167-a04dfd5526fa","updateTs":"1541634047000"},{"spelEvaluator":"v2","lastModifiedBy":"rsomasunderam@netflix.com","index":1,"description":"Builds nightly or when the cisys/nflx-jenkins package changes in stash.  Always builds the latest Jenkins LTS version.","triggers":[{"enabled":true,"job":"CISYS-nflx-jenkins","master":"opseng","type":"jenkins"}],"executionEngine":"v3","stageCounter":4,"appConfig":{},"limitConcurrent":true,"application":"jenkins","parallel":true,"name":"controller-unstable-scm-nightly","stages":[{"baseLabel":"release","baseOs":"xenial","cloudProviderType":"aws","extendedAttributes":{},"name":"Bake","notifications":[{"address":"jenkins-admin","level":"stage","type":"slack","when":["stage.failed"]}],"package":"nflx-jenkins","refId":"1","regions":["us-west-1","us-west-2"],"requisiteStageRefIds":[],"sendNotifications":true,"showAdvancedOptions":false,"storeType":"ebs","type":"bake","user":"kvick@netflix.com","vmType":"hvm"},{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["us-west-1a","us-west-1c"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":true,"ebsOptimized":false,"enabledMetrics":[],"freeFormDetails":"","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"BaseIAMRole","instanceMonitoring":false,"instanceType":"m5.xlarge","keyPair":"nf-test-keypair-a","legacyUdf":false,"loadBalancers":["jenkins-unstable-frontend"],"provider":"aws","securityGroups":["sg-d00987b5","sg-ab58f1ce","sg-be58f1db","sg-d7703ab0"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"unstable","strategy":"","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy","refId":"2","requisiteStageRefIds":["3"],"type":"deploy"},{"action":"scale_exact","capacity":{"desired":0,"max":0,"min":0},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-unstable","credentials":"test","name":"Resize Server Group","refId":"3","regions":["us-west-1"],"requisiteStageRefIds":["1"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-unstable","completeOtherBranchesThenFail":false,"continuePipeline":false,"credentials":"test","failPipeline":false,"name":"Destroy previous unstable master","refId":"4","regions":["us-west-1"],"requisiteStageRefIds":["2"],"target":"ancestor_asg_dynamic","type":"destroyServerGroup"},{"action":"scale_exact","capacity":{"desired":0,"max":0,"min":0},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-unstable-slave","credentials":"test","moniker":{"app":"jenkins","cluster":"jenkins-unstable-slave","detail":"slave","stack":"unstable"},"name":"Terminate all unstable slaves","refId":"5","regions":["us-west-1"],"requisiteStageRefIds":["2"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"action":"scale_exact","capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-unstable-slave","credentials":"test","moniker":{"app":"jenkins","cluster":"jenkins-unstable-slave","detail":"slave","stack":"unstable"},"name":"Create new unstable slaves","refId":"6","regions":["us-west-1"],"requisiteStageRefIds":["5"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"ROCK-jenkins-auth-acceptance-tests","master":"opseng","name":"Run auth tests","parameters":{"CONTROLLERS":"unstable"},"refId":"7","requisiteStageRefIds":["6"],"type":"jenkins"}],"id":"b9c061f0-58c6-11e5-967f-a5a6aeef80e9","updateTs":"1541634091000"},{"keepWaitingPipelines":false,"spelEvaluator":"v2","lastModifiedBy":"rsomasunderam@netflix.com","index":2,"description":"Gets ami from hydrogen and moves it to helium.","triggers":[],"executionEngine":"v3","limitConcurrent":true,"appConfig":{},"application":"jenkins","parallel":true,"name":"controller-promote-hydrogen-helium","stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-hydrogen","credentials":"build_prod","name":"Find Image from hydrogen","onlyEnabled":true,"refId":"1","regions":["us-west-2"],"requisiteStageRefIds":[],"selectionStrategy":"NEWEST","type":"findImage"},{"refId":"2","requisiteStageRefIds":["1"],"clusters":[{"application":"jenkins","strategy":"custom","capacity":{"desired":1,"max":1,"min":1},"targetHealthyDeployPercentage":100,"cooldown":10,"enabledMetrics":[],"healthCheckType":"EC2","healthCheckGracePeriod":600,"instanceMonitoring":false,"ebsOptimized":true,"iamRole":"jenkinsInstanceProfile","terminationPolicies":["Default"],"subnetType":"internal (vpc0)","availabilityZones":{"us-west-2":["us-west-2a","us-west-2b","us-west-2c"]},"keyPair":"nf-keypair-453078116140-us-west-2","suspendedProcesses":[],"securityGroups":["sg-c9fff0b7","sg-a9e2f2d7"],"stack":"helium","freeFormDetails":"","spotPrice":"","tags":{},"useAmiBlockDeviceMappings":false,"copySourceCustomBlockDeviceMappings":true,"account":"build_prod","cloudProvider":"aws","instanceType":"r4.2xlarge","legacyUdf":false,"loadBalancers":["jenkins-helium-frontend"],"pipelineParameters":{},"provider":"aws","strategyApplication":"jenkins","strategyPipeline":"4e5f6c00-d047-11e5-b553-65c9c7540d0f","targetGroups":[],"useSourceCapacity":true,"spelLoadBalancers":[],"spelTargetGroups":[]}],"name":"Deploy","type":"deploy"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"ROCK-jenkins-auth-acceptance-tests","master":"opseng","name":"Run auth tests","parameters":{"CONTROLLERS":"helium"},"refId":"3","requisiteStageRefIds":["5"],"type":"jenkins"},{"action":"scale_exact","capacity":{"desired":0,"max":0,"min":0},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-helium-slave","credentials":"build_prod","moniker":{"app":"jenkins","cluster":"jenkins-helium-slave","detail":"slave","stack":"helium"},"name":"Terminate all helium agents","refId":"4","regions":["us-west-2"],"requisiteStageRefIds":["2"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"action":"scale_exact","capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-helium-slave","credentials":"build_prod","moniker":{"app":"jenkins","cluster":"jenkins-helium-slave","detail":"slave","stack":"helium"},"name":"Create new helium agents","refId":"5","regions":["us-west-2"],"requisiteStageRefIds":["4"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"TL-JEN-test-generators","master":"helium","name":"Run generator test","parameters":{},"refId":"8","requisiteStageRefIds":["5"],"type":"jenkins"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"TL-JEN-test-tools","master":"helium","name":"Run credentials test","parameters":{},"refId":"9","requisiteStageRefIds":["5"],"type":"jenkins"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"TL-JEN-test-tools","master":"helium","name":"Run tools test - newt","parameters":{},"refId":"10","requisiteStageRefIds":["5"],"type":"jenkins"}],"id":"1290b2a0-ed80-4bdb-910d-224224b99b83","updateTs":"1540596241000"},{"keepWaitingPipelines":false,"spelEvaluator":"v2","lastModifiedBy":"rsomasunderam@netflix.com","index":3,"description":"Gets ami from unstable and moves it to staging.","triggers":[],"executionEngine":"v3","limitConcurrent":true,"appConfig":{},"application":"jenkins","parallel":true,"name":"controller-promote-unstable-staging","stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-unstable","credentials":"test","name":"Find Image from unstable","onlyEnabled":true,"refId":"1","regions":["us-west-1"],"requisiteStageRefIds":[],"selectionStrategy":"NEWEST","type":"findImage"},{"refId":"2","requisiteStageRefIds":["1"],"clusters":[{"application":"jenkins","strategy":"custom","capacity":{"desired":1,"max":1,"min":1},"targetHealthyDeployPercentage":100,"cooldown":10,"enabledMetrics":[],"healthCheckType":"EC2","healthCheckGracePeriod":600,"instanceMonitoring":false,"ebsOptimized":true,"iamRole":"jenkinsInstanceProfile","terminationPolicies":["Default"],"subnetType":"internal (vpc0)","availabilityZones":{"us-west-1":["us-west-1a","us-west-1c"]},"keyPair":"nf-test-keypair-a","suspendedProcesses":[],"securityGroups":["sg-ab58f1ce","sg-be58f1db","sg-d00987b5","sg-d7703ab0"],"stack":"staging","freeFormDetails":"","spotPrice":"","tags":{},"useAmiBlockDeviceMappings":false,"copySourceCustomBlockDeviceMappings":true,"account":"test","cloudProvider":"aws","instanceType":"r4.2xlarge","legacyUdf":false,"loadBalancers":["jenkins-staging-frontend"],"pipelineParameters":{},"provider":"aws","strategyApplication":"jenkins","strategyPipeline":"4e5f6c00-d047-11e5-b553-65c9c7540d0f","targetGroups":[],"useSourceCapacity":true,"spelLoadBalancers":[],"spelTargetGroups":[]}],"name":"Deploy","type":"deploy"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"ROCK-jenkins-auth-acceptance-tests","master":"opseng","name":"Run auth tests","parameters":{"CONTROLLERS":"staging"},"refId":"3","requisiteStageRefIds":["5"],"type":"jenkins"},{"action":"scale_exact","capacity":{"desired":0,"max":0,"min":0},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-staging-slave","credentials":"test","moniker":{"app":"jenkins","cluster":"jenkins-staging-slave","detail":"slave","stack":"staging"},"name":"Terminate all staging agents","refId":"4","regions":["us-west-1"],"requisiteStageRefIds":["2"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"action":"scale_exact","capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-staging-slave","credentials":"test","moniker":{"app":"jenkins","cluster":"jenkins-staging-slave","detail":"slave","stack":"staging"},"name":"Create new staging agents","refId":"5","regions":["us-west-1"],"requisiteStageRefIds":["4"],"resizeType":"exact","target":"current_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"TL-JEN-test-generators","master":"staging","name":"Run generator test","parameters":{},"refId":"8","requisiteStageRefIds":["5"],"type":"jenkins"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"TL-JEN-test-tools","master":"staging","name":"Run credentials test","parameters":{},"refId":"9","requisiteStageRefIds":["5"],"type":"jenkins"},{"completeOtherBranchesThenFail":true,"continuePipeline":false,"failPipeline":false,"job":"TL-JEN-test-tools","master":"staging","name":"Run tools test - newt","parameters":{},"refId":"10","requisiteStageRefIds":["5"],"type":"jenkins"}],"id":"279eabd1-da3f-4208-b21a-98eb9564017f","updateTs":"1540594930000"},{"spelEvaluator":"v2","lastModifiedBy":"gsimpson@netflix.com","index":4,"triggers":[{"type":"jenkins","enabled":true,"master":"opseng","job":"TL-Dynaslave-Package"}],"executionEngine":"v3","stageCounter":3,"appConfig":{},"limitConcurrent":true,"application":"jenkins","parallel":true,"name":"slave-unstable","stages":[{"baseLabel":"candidate","user":"cbennett@netflix.com","type":"bake","storeType":"ebs","refId":"1","requisiteStageRefIds":[],"name":"Bake","extendedAttributes":{},"regions":["us-east-1","us-west-1","us-west-2"],"cloudProviderType":"aws","vmType":"hvm","package":"nflx-dynaslave","baseOs":"xenial"},{"refId":"2","requisiteStageRefIds":["1"],"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["us-west-1a","us-west-1c"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":true,"dirty":{},"ebsOptimized":true,"enabledMetrics":[],"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":true,"instanceType":"m5.xlarge","keyPair":"nf-test-keypair-a","legacyUdf":false,"loadBalancers":[],"moniker":{"app":"jenkins","detail":"slave","stack":"unstable"},"provider":"aws","securityGroups":["sg-ab58f1ce","sg-be58f1db","sg-d00987b5"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"unstable","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"55ebe895-7115-4b65-9d50-1726f2d24491","subnetType":"internal (vpc0)","suspendedProcesses":[],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false,"useSourceCapacity":false},{"account":"build_prod","application":"jenkins","availabilityZones":{"us-west-2":["us-west-2a"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":false,"ebsOptimized":false,"enabledMetrics":[],"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":true,"instanceType":"m5.xlarge","keyPair":"nf-keypair-453078116140-us-west-2","loadBalancers":[],"moniker":{"app":"jenkins","detail":"slave","stack":"unstable"},"provider":"aws","securityGroups":["sg-954b66ea","sg-72416c0d","sg-c9fff0b7"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"unstable","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"55ebe895-7115-4b65-9d50-1726f2d24491","subnetType":"internal (vpc0)","suspendedProcesses":[],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false,"useSourceCapacity":false},{"account":"build_prod","application":"jenkins","availabilityZones":{"us-west-2":["us-west-2a","us-west-2b","us-west-2c"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":false,"ebsOptimized":false,"enabledMetrics":[],"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":true,"instanceType":"m5.xlarge","keyPair":"nf-keypair-453078116140-us-west-2","loadBalancers":[],"moniker":{"app":"jenkins","detail":"slave","stack":"hydrogen"},"pipelineParameters":{},"provider":"aws","securityGroups":["sg-72416c0d","sg-954b66ea","sg-c9fff0b7","sg-a9e2f2d7"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"hydrogen","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"4e5f6c00-d047-11e5-b553-65c9c7540d0f","subnetType":"internal (vpc0)","suspendedProcesses":[],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false,"useSourceCapacity":false},{"account":"test","application":"jenkins","availabilityZones":{"us-east-1":["us-east-1c","us-east-1d","us-east-1e"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":false,"ebsOptimized":false,"enabledMetrics":[],"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":true,"instanceType":"m5.xlarge","keyPair":"nf-test-keypair-a","loadBalancers":[],"moniker":{"app":"jenkins","detail":"slave","stack":"unstable"},"pipelineParameters":{},"provider":"aws","securityGroups":["sg-f0f19494","sg-f2f19496","sg-ea847c92"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"unstable","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"4e5f6c00-d047-11e5-b553-65c9c7540d0f","subnetType":"internal (vpc0)","suspendedProcesses":[],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false,"useSourceCapacity":false},{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["us-west-1a","us-west-1b","us-west-1c"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":false,"ebsOptimized":false,"enabledMetrics":[],"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":true,"instanceType":"m5.xlarge","keyPair":"nf-test-keypair-a","loadBalancers":[],"moniker":{"app":"jenkins","detail":"slave","stack":"hydrogen"},"pipelineParameters":{},"provider":"aws","securityGroups":["sg-ab58f1ce","sg-be58f1db","sg-d00987b5"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"hydrogen","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"4e5f6c00-d047-11e5-b553-65c9c7540d0f","subnetType":"internal (vpc0)","suspendedProcesses":[],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false,"useSourceCapacity":false}],"name":"Deploy","type":"deploy"},{"refId":"3","requisiteStageRefIds":["2"],"type":"shrinkCluster","name":"Shrink Cluster - Test/Unstable","cloudProviderType":"aws","regions":["us-east-1","us-west-1"],"cloudProvider":"aws","credentials":"test","shrinkToSize":1,"allowDeleteActive":true,"retainLargerOverNewer":"false","moniker":{"app":"jenkins","cluster":"jenkins-unstable-slave","detail":"slave","stack":"unstable"},"cluster":"jenkins-unstable-slave","failPipeline":false,"continuePipeline":false,"completeOtherBranchesThenFail":false},{"refId":"4","requisiteStageRefIds":["2"],"type":"shrinkCluster","name":"Shrink Cluster - Test/Hydrogen","cloudProviderType":"aws","regions":["us-east-1","us-west-1"],"cloudProvider":"aws","credentials":"test","shrinkToSize":1,"allowDeleteActive":true,"retainLargerOverNewer":"false","moniker":{"app":"jenkins","cluster":"jenkins-hydrogen-slave","detail":"slave","stack":"hydrogen"},"cluster":"jenkins-hydrogen-slave","failPipeline":false,"continuePipeline":false,"completeOtherBranchesThenFail":false},{"refId":"5","requisiteStageRefIds":["2"],"type":"shrinkCluster","name":"Shrink Cluster - BuildProd/Hydrogen","cloudProviderType":"aws","regions":["us-west-2"],"cloudProvider":"aws","credentials":"build_prod","shrinkToSize":1,"allowDeleteActive":true,"retainLargerOverNewer":"false","moniker":{"app":"jenkins","cluster":"jenkins-hydrogen-slave","detail":"slave","stack":"hydrogen"},"cluster":"jenkins-hydrogen-slave","failPipeline":false,"continuePipeline":false,"completeOtherBranchesThenFail":false},{"refId":"6","requisiteStageRefIds":["2"],"type":"shrinkCluster","name":"Shrink Cluster - BuildProd/Unstable","cloudProviderType":"aws","regions":["us-west-2"],"cloudProvider":"aws","credentials":"build_prod","shrinkToSize":1,"allowDeleteActive":true,"retainLargerOverNewer":"false","moniker":{"app":"jenkins","cluster":"jenkins-unstable-slave","detail":"slave","stack":"unstable"},"cluster":"jenkins-unstable-slave","failPipeline":false,"continuePipeline":false,"completeOtherBranchesThenFail":false}],"id":"ea1e09c6-2894-4d52-82de-d6f38517f11b","updateTs":"1544122941000"},{"keepWaitingPipelines":false,"parameterConfig":[],"spelEvaluator":"v2","lastModifiedBy":"jenkins-179727101194","index":5,"triggers":[{"cronExpression":"0 0 0 1W 1/1 ? *","enabled":true,"type":"cron","id":"ea5f81e1-216f-4196-b74f-4300dc4956e4"}],"executionEngine":"v3","limitConcurrent":true,"application":"jenkins","name":"agent-rollout","stages":[{"requisiteStageRefIds":[],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh staging,helium","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on staging,helium."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"1","name":"Deploy staging,helium","user":"builds@netflix.com"},{"name":"Wait 1","type":"wait","waitTime":86400.0,"refId":"2","user":"builds@netflix.com","requisiteStageRefIds":["1"]},{"requisiteStageRefIds":["2"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh buildstest,argon","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on buildstest,argon."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"3","name":"Deploy buildstest,argon","user":"builds@netflix.com"},{"name":"Wait 2","type":"wait","waitTime":86400.0,"refId":"4","user":"builds@netflix.com","requisiteStageRefIds":["3"]},{"requisiteStageRefIds":["4"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh opseng,engedu","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on opseng,engedu."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"5","name":"Deploy opseng,engedu","user":"builds@netflix.com"},{"name":"Wait 3","type":"wait","waitTime":86400.0,"refId":"6","user":"builds@netflix.com","requisiteStageRefIds":["5"]},{"requisiteStageRefIds":["6"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh spinnaker,mimir,titus,cldsec","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on spinnaker,mimir,titus,cldsec."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"7","name":"Deploy spinnaker,mimir,titus,cldsec","user":"builds@netflix.com"},{"name":"Wait 4","type":"wait","waitTime":86400.0,"refId":"8","user":"builds@netflix.com","requisiteStageRefIds":["7"]},{"requisiteStageRefIds":["8"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh bpeng,cbp,contentdelivery,cpe","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on bpeng,cbp,contentdelivery,cpe."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"9","name":"Deploy bpeng,cbp,contentdelivery,cpe","user":"builds@netflix.com"},{"name":"Wait 5","type":"wait","waitTime":86400.0,"refId":"10","user":"builds@netflix.com","requisiteStageRefIds":["9"]},{"requisiteStageRefIds":["10"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh dse,ecom,edge,gps,krypton","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on dse,ecom,edge,gps,krypton."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"11","name":"Deploy dse,ecom,edge,gps,krypton","user":"builds@netflix.com"},{"name":"Wait 6","type":"wait","waitTime":86400.0,"refId":"12","user":"builds@netflix.com","requisiteStageRefIds":["11"]},{"requisiteStageRefIds":["12"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh mce,membership,merch,mobile","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on mce,membership,merch,mobile."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"13","name":"Deploy mce,membership,merch,mobile","user":"builds@netflix.com"},{"name":"Wait 7","type":"wait","waitTime":86400.0,"refId":"14","user":"builds@netflix.com","requisiteStageRefIds":["13"]},{"requisiteStageRefIds":["14"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh nts,platform,ppd,producteng","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on nts,platform,ppd,producteng."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"15","name":"Deploy nts,platform,ppd,producteng","user":"builds@netflix.com"},{"name":"Wait 8","type":"wait","waitTime":86400.0,"refId":"16","user":"builds@netflix.com","requisiteStageRefIds":["15"]},{"requisiteStageRefIds":["16"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/agents.sh recommendations,sct,ui,uiplatform,vms","sendNotifications":true,"notifications":[{"address":"engineering-help","level":"stage","message":{"stage.complete":{"text":"A new version of nflx-dynaslave has been deployed on recommendations,sct,ui,uiplatform,vms."}},"type":"slack","when":["stage.complete"]},{"address":"buildtools@netflix.com","level":"stage","type":"email","when":["stage.failed"]}],"refId":"17","name":"Deploy recommendations,sct,ui,uiplatform,vms","user":"builds@netflix.com"}],"id":"fc219d6c-5b8f-4e7c-ab80-219330988182","updateTs":"1547804354000"},{"keepWaitingPipelines":false,"parameterConfig":[{"name":"plugin","description":"Identifier of plugin","hasOptions":true,"options":[{"value":"blesk"},{"value":"nflx-metrics"},{"value":"rocket-ci"},{"value":"seppuku"},{"value":"simple-smooth"}]},{"name":"version","description":"Version of plugin"}],"spelEvaluator":"v2","lastModifiedBy":"jenkins-179727101194","index":6,"triggers":[],"executionEngine":"v3","limitConcurrent":false,"application":"jenkins","name":"deploy-plugin","stages":[{"requisiteStageRefIds":[],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh unstable,hydrogen ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"1","name":"Deploy unstable,hydrogen","user":"builds@netflix.com"},{"requisiteStageRefIds":["1"],"type":"manualJudgment","notifications":[],"judgmentInputs":[],"failPipeline":true,"instructions":"Please verify that the agents on `unstable,hydrogen` are working as expected.","propagateAuthenticationContext":true,"refId":"2","name":"Verify unstable,hydrogen","user":"builds@netflix.com"},{"requisiteStageRefIds":["2"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh staging,helium ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"3","name":"Deploy staging,helium","user":"builds@netflix.com"},{"requisiteStageRefIds":["3"],"type":"manualJudgment","notifications":[],"judgmentInputs":[],"failPipeline":true,"instructions":"Please verify that the agents on `staging,helium` are working as expected.","propagateAuthenticationContext":true,"refId":"4","name":"Verify staging,helium","user":"builds@netflix.com"},{"requisiteStageRefIds":["4"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh buildstest,argon ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"5","name":"Deploy buildstest,argon","user":"builds@netflix.com"},{"requisiteStageRefIds":["5"],"type":"manualJudgment","notifications":[],"judgmentInputs":[],"failPipeline":true,"instructions":"Please verify that the agents on `buildstest,argon` are working as expected.","propagateAuthenticationContext":true,"refId":"6","name":"Verify buildstest,argon","user":"builds@netflix.com"},{"requisiteStageRefIds":["6"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh opseng,engedu ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"7","name":"Deploy opseng,engedu","user":"builds@netflix.com"},{"name":"Wait 3","type":"wait","waitTime":86400.0,"refId":"8","user":"builds@netflix.com","requisiteStageRefIds":["7"]},{"requisiteStageRefIds":["8"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh spinnaker,mimir,titus,cldsec ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"9","name":"Deploy spinnaker,mimir,titus,cldsec","user":"builds@netflix.com"},{"name":"Wait 4","type":"wait","waitTime":86400.0,"refId":"10","user":"builds@netflix.com","requisiteStageRefIds":["9"]},{"requisiteStageRefIds":["10"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh bpeng,cbp,contentdelivery,cpe ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"11","name":"Deploy bpeng,cbp,contentdelivery,cpe","user":"builds@netflix.com"},{"name":"Wait 5","type":"wait","waitTime":86400.0,"refId":"12","user":"builds@netflix.com","requisiteStageRefIds":["11"]},{"requisiteStageRefIds":["12"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh dse,ecom,edge,gps,krypton ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"13","name":"Deploy dse,ecom,edge,gps,krypton","user":"builds@netflix.com"},{"name":"Wait 6","type":"wait","waitTime":86400.0,"refId":"14","user":"builds@netflix.com","requisiteStageRefIds":["13"]},{"requisiteStageRefIds":["14"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh mce,membership,merch,mobile ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"15","name":"Deploy mce,membership,merch,mobile","user":"builds@netflix.com"},{"name":"Wait 7","type":"wait","waitTime":86400.0,"refId":"16","user":"builds@netflix.com","requisiteStageRefIds":["15"]},{"requisiteStageRefIds":["16"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh nts,platform,ppd,producteng ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"17","name":"Deploy nts,platform,ppd,producteng","user":"builds@netflix.com"},{"name":"Wait 8","type":"wait","waitTime":86400.0,"refId":"18","user":"builds@netflix.com","requisiteStageRefIds":["17"]},{"requisiteStageRefIds":["18"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh recommendations,sct,ui,uiplatform,vms ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"19","name":"Deploy recommendations,sct,ui,uiplatform,vms","user":"builds@netflix.com"}],"id":"5025FD2D-515D-4E34-A2F8-C220AA992D38","updateTs":"1547804360000"},{"keepWaitingPipelines":false,"parameterConfig":[{"name":"plugin","description":"Identifier of plugin","hasOptions":true,"options":[{"value":"blesk"},{"value":"nflx-metrics"},{"value":"rocket-ci"},{"value":"seppuku"},{"value":"simple-smooth"}]},{"name":"version","description":"Version of plugin"}],"spelEvaluator":"v2","lastModifiedBy":"jenkins-179727101194","index":7,"triggers":[],"executionEngine":"v3","limitConcurrent":false,"application":"jenkins","name":"deploy-plugin","stages":[{"requisiteStageRefIds":[],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh unstable,hydrogen ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"1","name":"Deploy unstable,hydrogen","user":"builds@netflix.com"},{"requisiteStageRefIds":["1"],"type":"manualJudgment","notifications":[],"judgmentInputs":[],"failPipeline":true,"instructions":"Please verify that the agents on `unstable,hydrogen` are working as expected.","propagateAuthenticationContext":true,"refId":"2","name":"Verify unstable,hydrogen","user":"builds@netflix.com"},{"requisiteStageRefIds":["2"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh staging,helium ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"3","name":"Deploy staging,helium","user":"builds@netflix.com"},{"requisiteStageRefIds":["3"],"type":"manualJudgment","notifications":[],"judgmentInputs":[],"failPipeline":true,"instructions":"Please verify that the agents on `staging,helium` are working as expected.","propagateAuthenticationContext":true,"refId":"4","name":"Verify staging,helium","user":"builds@netflix.com"},{"requisiteStageRefIds":["4"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh buildstest,argon ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"5","name":"Deploy buildstest,argon","user":"builds@netflix.com"},{"requisiteStageRefIds":["5"],"type":"manualJudgment","notifications":[],"judgmentInputs":[],"failPipeline":true,"instructions":"Please verify that the agents on `buildstest,argon` are working as expected.","propagateAuthenticationContext":true,"refId":"6","name":"Verify buildstest,argon","user":"builds@netflix.com"},{"requisiteStageRefIds":["6"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh opseng,engedu ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"7","name":"Deploy opseng,engedu","user":"builds@netflix.com"},{"name":"Wait 3","type":"wait","waitTime":86400.0,"refId":"8","user":"builds@netflix.com","requisiteStageRefIds":["7"]},{"requisiteStageRefIds":["8"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh spinnaker,mimir,titus,cldsec ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"9","name":"Deploy spinnaker,mimir,titus,cldsec","user":"builds@netflix.com"},{"name":"Wait 4","type":"wait","waitTime":86400.0,"refId":"10","user":"builds@netflix.com","requisiteStageRefIds":["9"]},{"requisiteStageRefIds":["10"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh bpeng,cbp,contentdelivery,cpe ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"11","name":"Deploy bpeng,cbp,contentdelivery,cpe","user":"builds@netflix.com"},{"name":"Wait 5","type":"wait","waitTime":86400.0,"refId":"12","user":"builds@netflix.com","requisiteStageRefIds":["11"]},{"requisiteStageRefIds":["12"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh dse,ecom,edge,gps,krypton ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"13","name":"Deploy dse,ecom,edge,gps,krypton","user":"builds@netflix.com"},{"name":"Wait 6","type":"wait","waitTime":86400.0,"refId":"14","user":"builds@netflix.com","requisiteStageRefIds":["13"]},{"requisiteStageRefIds":["14"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh mce,membership,merch,mobile ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"15","name":"Deploy mce,membership,merch,mobile","user":"builds@netflix.com"},{"name":"Wait 7","type":"wait","waitTime":86400.0,"refId":"16","user":"builds@netflix.com","requisiteStageRefIds":["15"]},{"requisiteStageRefIds":["16"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh nts,platform,ppd,producteng ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"17","name":"Deploy nts,platform,ppd,producteng","user":"builds@netflix.com"},{"name":"Wait 8","type":"wait","waitTime":86400.0,"refId":"18","user":"builds@netflix.com","requisiteStageRefIds":["17"]},{"requisiteStageRefIds":["18"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-plugin.sh recommendations,sct,ui,uiplatform,vms ${trigger.parameters.plugin} ${trigger.parameters.version}","refId":"19","name":"Deploy recommendations,sct,ui,uiplatform,vms","user":"builds@netflix.com"}],"id":"5025FD2D-515D-4E34-A2F8-C220AA992D38","updateTs":"1547804360000"},{"parameterConfig":[{"description":"Name of stack to upgrade","name":"stack"},{"description":"Availability zone of volmount - cluster and volume must be in same zone","name":"avail_zone"},{"description":"EC2 instance type for cluster","name":"instance_type"}],"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":8,"description":"Called by the update action on a master.  Pulls ami from staging and creates a new instance in the cluster.","triggers":[],"executionEngine":"v3","stageCounter":3,"appConfig":{},"limitConcurrent":false,"application":"jenkins","parallel":true,"stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-staging","comments":"","credentials":"test","name":"Find Image","onlyEnabled":true,"refId":"2","regions":["us-west-1"],"requisiteStageRefIds":[],"selectionStrategy":"NEWEST","type":"findImage"},{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["${trigger.parameters.avail_zone}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":false,"dirty":{},"ebsOptimized":true,"enabledMetrics":[],"freeFormDetails":"","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"BaseIAMRole","instanceMonitoring":false,"instanceType":"r5.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":["jenkins-${trigger.parameters.stack}-frontend"],"pipelineParameters":{},"provider":"aws","securityGroups":["sg-d00987b5","sg-be58f1db","sg-ab58f1ce"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"${trigger.parameters.stack}","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"4e5f6c00-d047-11e5-b553-65c9c7540d0f","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{"jenkins:controller":"${trigger.parameters.stack}"},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy","refId":"3","requisiteStageRefIds":["2"],"type":"deploy"},{"continuePipeline":false,"failPipeline":true,"job":"ROCK-jenkins-auth-acceptance-tests","markUnstableAsSuccessful":true,"master":"opseng","name":"Jenkins","parameters":{},"refId":"4","requisiteStageRefIds":["3"],"type":"jenkins","waitForCompletion":false}],"name":"controller-update-vpc0","id":"4e30f137-b880-48ad-90fa-4d5125dc1424","updateTs":"1547763705000"},{"parameterConfig":[{"description":"Name of stack to upgrade","name":"stack"},{"description":"Availability zone of volmount - cluster and volume must be in same zone","name":"avail_zone"},{"description":"EC2 instance type for cluster","name":"instance_type"}],"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":9,"description":"Called by the update action on a master.  Pulls ami from staging and creates a new instance in the cluster.","triggers":[],"executionEngine":"v3","stageCounter":3,"appConfig":{},"limitConcurrent":false,"application":"jenkins","parallel":true,"stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-staging","comments":"","credentials":"test","name":"Find Image","onlyEnabled":true,"refId":"2","regions":["us-west-1"],"requisiteStageRefIds":[],"selectionStrategy":"NEWEST","type":"findImage"},{"refId":"3","requisiteStageRefIds":["2"],"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["${trigger.parameters.avail_zone}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"ebsOptimized":false,"healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"BaseIAMRole","instanceMonitoring":false,"instanceType":"${trigger.parameters.instance_type}","keyPair":"nf-test-keypair-a","loadBalancers":["jenkins-${trigger.parameters.stack}-vpc0"],"pipelineParameters":{},"provider":"aws","securityGroups":["sg-d00987b5","sg-be58f1db","sg-ab58f1ce"],"stack":"${trigger.parameters.stack}","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"4e5f6c00-d047-11e5-b553-65c9c7540d0f","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{"jenkins:controller":"${trigger.parameters.stack}"},"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"]}],"name":"Deploy","type":"deploy"},{"continuePipeline":false,"failPipeline":true,"job":"ROCK-jenkins-auth-acceptance-tests","markUnstableAsSuccessful":true,"master":"opseng","name":"Run auth tests","parameters":{},"refId":"4","requisiteStageRefIds":["3"],"type":"jenkins","waitForCompletion":false},{"continuePipeline":false,"failPipeline":true,"job":"TL-JEN-install-update-scripts","master":"opseng","name":"Install scripts","parameters":{"MASTER":"${trigger.parameters.stack}"},"refId":"5","requisiteStageRefIds":["3"],"type":"jenkins"}],"name":"jenkins-update","id":"7978cc10-cf93-11e5-815a-df3b5cf604f3","updateTs":"1547763704000"},{"keepWaitingPipelines":false,"parameterConfig":[{"description":"Name for master","name":"master_name"},{"description":"Which AZ should the master and slaves be in","hasOptions":true,"name":"availability_zone","options":[{"value":"us-west-1a"},{"value":"us-west-1c"},{"value":"us-west-2a"}]},{"description":"which clustre should be used to find images","name":"source cluster"}],"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":10,"description":"Create a new master by providing a stack name.  You must create the ELB and the route53 before running the pipeline. Assumes existence of ELB named like jenkins-<master_name>.","triggers":[],"executionEngine":"v3","limitConcurrent":false,"appConfig":{},"application":"jenkins","parallel":true,"name":"controller-create","stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-${parameters['cluster']}","credentials":"test","name":"Find Master Image from Cluster","onlyEnabled":true,"refId":"1","regions":["us-west-1"],"requisiteStageRefIds":["5"],"selectionStrategy":"NEWEST","type":"findImage"},{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["${parameters['availability_zone']}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"ebsOptimized":true,"healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":false,"instanceType":"r3.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":["jenkins-${parameters['master_name']}-vpc0"],"provider":"aws","securityGroups":[],"stack":"${parameters['master_name']}","strategy":"","strategyApplication":"jenkins","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy Master","refId":"2","requisiteStageRefIds":["1"],"type":"deploy"},{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-${parameters['cluster']}-slave","comments":"The slave will not pass health check until the master exists.","credentials":"test","name":"Find Slave Image from Cluster","onlyEnabled":true,"refId":"3","regions":["us-west-1"],"requisiteStageRefIds":["2"],"selectionStrategy":"NEWEST","type":"findImage"},{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["${parameters['availability_zone']}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"ebsOptimized":false,"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":false,"instanceType":"m3.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":[],"provider":"aws","securityGroups":["sg-d00987b5","sg-d60987b3"],"stack":"${parameters['master_name']}","strategy":"highlander","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy Slave","refId":"4","requisiteStageRefIds":["3"],"type":"deploy"},{"failPipeline":true,"instructions":"Create an ELB named `jenkins-${master_name}`.","judgmentInputs":[{"value":"jenkins-${master_name} ELB exists"}],"name":"Manual Judgment","notifications":[],"refId":"5","requisiteStageRefIds":[],"type":"manualJudgment"}],"id":"7251b5fd-4c13-47a9-9dd5-0788ddc3e086","updateTs":"1547763705000"},{"keepWaitingPipelines":false,"parameterConfig":[{"description":"Name for master","name":"master_name"},{"description":"Which AZ should the master and slaves be in","hasOptions":true,"name":"availability_zone","options":[{"value":"us-west-1a"},{"value":"us-west-1c"}]},{"description":"which clustre should be used to find images","name":"source cluster"}],"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":11,"description":"Create a new master by providing a stack name.  You must create the ELB and the route53 before running the pipeline. Assumes existence of ELB named like jenkins-<master_name>.","triggers":[],"executionEngine":"v3","limitConcurrent":false,"appConfig":{},"application":"jenkins","parallel":true,"name":"controller-create-us-west-2","stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-${parameters['cluster']}","credentials":"test","name":"Find Master Image from Cluster","onlyEnabled":true,"refId":"1","regions":["us-west-1"],"requisiteStageRefIds":["5"],"selectionStrategy":"NEWEST","type":"findImage"},{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["${parameters['availability_zone']}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"ebsOptimized":true,"healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":false,"instanceType":"r3.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":["jenkins-${parameters['master_name']}-vpc0"],"provider":"aws","securityGroups":[],"stack":"${parameters['master_name']}","strategy":"","strategyApplication":"jenkins","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy Master","refId":"2","requisiteStageRefIds":["1"],"type":"deploy"},{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-${parameters['cluster']}-slave","comments":"The slave will not pass health check until the master exists.","credentials":"test","name":"Find Slave Image from Cluster","onlyEnabled":true,"refId":"3","regions":["us-west-1"],"requisiteStageRefIds":["2"],"selectionStrategy":"NEWEST","type":"findImage"},{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["${parameters['availability_zone']}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"ebsOptimized":false,"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":false,"instanceType":"m3.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":[],"provider":"aws","securityGroups":["sg-d00987b5","sg-d60987b3"],"stack":"${parameters['master_name']}","strategy":"highlander","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy Slave","refId":"4","requisiteStageRefIds":["3"],"type":"deploy"},{"failPipeline":true,"instructions":"Create an ELB named `jenkins-${master_name}`.","judgmentInputs":[{"value":"jenkins-${master_name} ELB exists"}],"name":"Manual Judgment","notifications":[],"refId":"5","requisiteStageRefIds":[],"type":"manualJudgment"}],"id":"ca0af1b1-a7a3-44aa-9a1b-32371b53197a","updateTs":"1547763705000"},{"parameterConfig":[{"description":"Name of the shard to upgrade.","name":"shard_name"},{"description":"Type of instance","name":"instance_type","default":"r3.xlarge"}],"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":12,"triggers":[],"executionEngine":"v3","stageCounter":24,"appConfig":{},"limitConcurrent":false,"application":"jenkins","parallel":true,"stages":[{"cluster":"jenkins-unstable","name":"Get Jenkins AMI","onlyEnabled":true,"regions":["us-west-1"],"cloudProviderType":"aws","credentials":"test","type":"findImage","selectionStrategy":"FAIL","cloudProvider":"aws","refId":"11","requisiteStageRefIds":[]},{"type":"deploy","name":"Update Launch Config","clusters":[{"account":"test","healthCheckType":"EC2","cooldown":10,"termination":{"totalRelaunches":0,"relaunchAllInstances":false,"order":"oldest","concurrentRelaunches":1},"securityGroups":["sg-be58f1db","sg-ab58f1ce","sg-d00987b5"],"targetHealthyDeployPercentage":100,"instanceType":"${trigger.parameters.instance_type}","capacity":{"desired":1,"min":1,"max":1},"provider":"aws","keyPair":"nf-test-keypair-a","loadBalancers":["jenkins-buildstest-vpc0"],"freeFormDetails":"","useSourceCapacity":false,"instanceMonitoring":false,"stack":"${trigger.parameters.shard_name}","availabilityZones":{"us-west-1":["us-west-1a","us-west-1c"]},"terminationPolicies":["Default"],"strategy":"rollingpush","iamRole":"BaseIAMRole","subnetType":"internal (vpc0)","application":"jenkins","suspendedProcesses":["AZRebalance"],"ebsOptimized":false,"healthCheckGracePeriod":600,"cloudProvider":"aws"}],"refId":"14","requisiteStageRefIds":["11"]}],"name":"controller-update-launch-configs","id":"94bfe350-9938-11e5-b553-65c9c7540d0f","updateTs":"1547763705000"},{"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":13,"triggers":[{"application":"jenkins","enabled":true,"job":"TL-Dynaslave-Package","master":"opseng","pipeline":"ea1e09c6-2894-4d52-82de-d6f38517f11b","status":["successful"],"type":"pipeline"}],"executionEngine":"v3","stageCounter":3,"appConfig":{},"application":"jenkins","parallel":true,"name":"slave-unstable-opseng","stages":[{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["us-west-1a","us-west-1c"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":true,"ebsOptimized":false,"enabledMetrics":[],"freeFormDetails":"slave-unstable","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"BaseIAMRole","instanceMonitoring":true,"instanceType":"m5.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":[],"provider":"aws","securityGroups":["sg-ab58f1ce","sg-be58f1db","sg-d00987b5"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"opseng","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"55ebe895-7115-4b65-9d50-1726f2d24491","subnetType":"internal (vpc0)","suspendedProcesses":[],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false,"useSourceCapacity":false},{"account":"test","application":"jenkins","availabilityZones":{"us-east-1":["us-east-1c","us-east-1d","us-east-1e"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":true,"ebsOptimized":false,"enabledMetrics":[],"freeFormDetails":"slave-unstable","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"BaseIAMRole","instanceMonitoring":true,"instanceType":"m5.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":[],"provider":"aws","securityGroups":["sg-f0f19494","sg-f2f19496","sg-ea847c92"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"opseng","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"55ebe895-7115-4b65-9d50-1726f2d24491","subnetType":"internal (vpc0)","suspendedProcesses":[],"tags":{},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false,"useSourceCapacity":false}],"name":"Deploy","refId":"2","requisiteStageRefIds":["4"],"type":"deploy"},{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-unstable-slave","credentials":"test","name":"Find Image from Cluster","onlyEnabled":true,"refId":"4","regions":["us-west-1"],"requisiteStageRefIds":[],"selectionStrategy":"NEWEST","type":"findImage"},{"allowDeleteActive":true,"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-opseng-slave-unstable","credentials":"test","moniker":{"app":"jenkins","cluster":"jenkins-opseng-slave-unstable","detail":"slave-unstable","stack":"opseng"},"name":"Shrink Cluster","refId":"5","regions":["us-east-1","us-west-1"],"requisiteStageRefIds":["2"],"retainLargerOverNewer":"false","shrinkToSize":1,"type":"shrinkCluster"}],"id":"e45ddbc0-1c3c-11e5-89a8-65c9c7540d0f","updateTs":"1547763710000"},{"keepWaitingPipelines":false,"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":14,"triggers":[{"enabled":true,"type":"jenkins","master":"opseng","job":"TL-nflx-agent"}],"executionEngine":"v3","limitConcurrent":true,"application":"jenkins","parallel":true,"name":"slave-agent","stages":[{"refId":"1","requisiteStageRefIds":[],"type":"bake","name":"Bake","cloudProviderType":"aws","extendedAttributes":{},"regions":["us-east-1","us-west-1","us-west-2"],"user":"gsimpson@netflix.com","vmType":"hvm","storeType":"ebs","baseOs":"xenial","baseLabel":"release","package":"nflx-agent"},{"refId":"2","requisiteStageRefIds":["1"],"type":"deploy","name":"Deploy","clusters":[{"application":"jenkins","strategy":"redblack","stack":"upgrade","freeFormDetails":"robo","cooldown":10,"healthCheckGracePeriod":600,"healthCheckType":"EC2","terminationPolicies":["Default"],"loadBalancers":[],"useSourceCapacity":true,"capacity":{"min":1,"max":1,"desired":1},"targetHealthyDeployPercentage":100,"availabilityZones":{"us-west-1":["us-west-1a","us-west-1c"]},"suspendedProcesses":[],"tags":{},"useAmiBlockDeviceMappings":false,"subnetType":"internal (vpc0)","instanceType":"m3.large","iamRole":"jenkinsInstanceProfile","keyPair":"nf-test-keypair-a","instanceMonitoring":false,"ebsOptimized":false,"securityGroups":["sg-ab58f1ce","sg-be58f1db","sg-d00987b5","sg-d60987b3"],"provider":"aws","cloudProvider":"aws","account":"test"}]}],"id":"8af15e97-d6ad-475c-8626-987ec8d658c0","updateTs":"1547763710000"},{"keepWaitingPipelines":false,"parameterConfig":[{"default":"buildstest-slave","description":"The Jenkins xenial slave pool to upgrade","hasOptions":true,"name":"slave_cluster","options":[{"value":"buildstest-slave"},{"value":"bootcamp"},{"value":"opseng-slave"},{"value":"opseng-slave-highlander"}],"required":true}],"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":15,"triggers":[],"executionEngine":"v3","limitConcurrent":true,"appConfig":{},"application":"jenkins","name":"Upgrade Xenial slaves by shard","stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-opseng-slave-unstable","credentials":"test","moniker":{"app":"jenkins","cluster":"jenkins-opseng-slave-unstable","detail":"slave-unstable","stack":"opseng"},"name":"Find Image from Cluster","onlyEnabled":true,"refId":"1","regions":["us-west-1"],"requisiteStageRefIds":[],"selectionStrategy":"NEWEST","type":"findImage"},{"application":"jenkins","cloudProvider":"aws","cloudProviderType":"aws","copySourceCustomBlockDeviceMappings":false,"credentials":"test","freeFormDetails":"slave","name":"Clone Server Group","refId":"4","region":"us-west-1","requisiteStageRefIds":["6"],"stack":"buildstest","strategy":"","target":"current_asg_dynamic","targetCluster":"jenkins-${parameters['slave_cluster']}","type":"cloneServerGroup","useAmiBlockDeviceMappings":false,"useSourceCapacity":true},{"allowDeleteActive":true,"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-${parameters['slave_cluster']}","credentials":"test","name":"Shrink Cluster","refId":"6","regions":["us-west-1"],"requisiteStageRefIds":["1"],"retainLargerOverNewer":"false","shrinkToSize":1,"type":"shrinkCluster"},{"action":"scale_exact","capacity":{"min":0},"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-${parameters['slave_cluster']}","credentials":"test","name":"Resize Server Group","refId":"7","regions":["us-west-1"],"requisiteStageRefIds":["4"],"resizeType":"exact","target":"ancestor_asg_dynamic","targetHealthyDeployPercentage":100,"type":"resizeServerGroup"}],"id":"4843407c-abb1-4580-96f5-91b7903e3f41","updateTs":"1547763705000"},{"spelEvaluator":"v2","lastModifiedBy":"sghill@netflix.com","index":16,"triggers":[{"type":"jenkins","enabled":true,"master":"buildstest","job":"cisys-nflx-jenkins-agent-docker-release"}],"executionEngine":"v3","stageCounter":3,"appConfig":{},"application":"jenkins","parallel":true,"name":"agent-unstable","stages":[{"baseLabel":"candidate","user":"cbennett@netflix.com","type":"bake","storeType":"ebs","refId":"1","requisiteStageRefIds":[],"name":"Bake","extendedAttributes":{},"regions":["us-east-1","us-west-1","us-west-2"],"cloudProviderType":"aws","vmType":"hvm","package":"nflx-jenkins-agent","baseOs":"xenial"},{"type":"deploy","name":"Deploy","clusters":[{"application":"jenkins","strategy":"highlander","capacity":{"min":1,"max":1,"desired":1},"targetHealthyDeployPercentage":100,"cooldown":10,"enabledMetrics":[],"healthCheckType":"EC2","healthCheckGracePeriod":600,"instanceMonitoring":false,"ebsOptimized":false,"iamRole":"jenkinsInstanceProfile","terminationPolicies":["Default"],"subnetType":"internal (vpc0)","availabilityZones":{"us-west-2":["us-west-2a","us-west-2b","us-west-2c"]},"keyPair":"nf-keypair-453078116140-us-west-2","suspendedProcesses":[],"securityGroups":[],"spotPrice":"","tags":{},"useAmiBlockDeviceMappings":false,"copySourceCustomBlockDeviceMappings":false,"moniker":{"app":"jenkins","stack":"unstable","detail":"agent"},"stack":"unstable","freeFormDetails":"agent","instanceType":"m3.xlarge","provider":"aws","cloudProvider":"aws","loadBalancers":[],"targetGroups":[],"account":"build_prod"}],"refId":"2","requisiteStageRefIds":["3"]},{"refId":"3","requisiteStageRefIds":["1"],"type":"manualJudgment","name":"WTF","notifications":[],"judgmentInputs":[],"failPipeline":true}],"id":"2f193c35-0593-418d-bc55-a2cb84667e4a","updateTs":"1547763710000"},{"keepWaitingPipelines":false,"parameterConfig":[],"spelEvaluator":"v2","lastModifiedBy":"jenkins-179727101194","index":17,"triggers":[],"executionEngine":"v3","limitConcurrent":false,"application":"jenkins","name":"update-controller","stages":[{"requisiteStageRefIds":[],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh buildstest,argon","refId":"1","name":"Update buildstest,argon","user":"builds@netflix.com"},{"name":"Wait 2","type":"wait","waitTime":86400.0,"refId":"2","user":"builds@netflix.com","requisiteStageRefIds":["1"]},{"requisiteStageRefIds":["2"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh opseng,engedu","refId":"3","name":"Deploy opseng,engedu","user":"builds@netflix.com"},{"name":"Verify opseng,engedu","type":"wait","waitTime":86400.0,"refId":"4","user":"builds@netflix.com","requisiteStageRefIds":["3"]},{"requisiteStageRefIds":["4"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh spinnaker,mimir,titus,cldsec","refId":"5","name":"Deploy spinnaker,mimir,titus,cldsec","user":"builds@netflix.com"},{"name":"Verify spinnaker,mimir,titus,cldsec","type":"wait","waitTime":86400.0,"refId":"6","user":"builds@netflix.com","requisiteStageRefIds":["5"]},{"requisiteStageRefIds":["6"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh bpeng,cbp,contentdelivery,cpe","refId":"7","name":"Deploy bpeng,cbp,contentdelivery,cpe","user":"builds@netflix.com"},{"name":"Verify bpeng,cbp,contentdelivery,cpe","type":"wait","waitTime":86400.0,"refId":"8","user":"builds@netflix.com","requisiteStageRefIds":["7"]},{"requisiteStageRefIds":["8"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh dse,ecom,edge,gps,krypton","refId":"9","name":"Deploy dse,ecom,edge,gps,krypton","user":"builds@netflix.com"},{"name":"Verify dse,ecom,edge,gps,krypton","type":"wait","waitTime":86400.0,"refId":"10","user":"builds@netflix.com","requisiteStageRefIds":["9"]},{"requisiteStageRefIds":["10"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh mce,membership,merch,mobile","refId":"11","name":"Deploy mce,membership,merch,mobile","user":"builds@netflix.com"},{"name":"Verify mce,membership,merch,mobile","type":"wait","waitTime":86400.0,"refId":"12","user":"builds@netflix.com","requisiteStageRefIds":["11"]},{"requisiteStageRefIds":["12"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh nts,platform,ppd,producteng","refId":"13","name":"Deploy nts,platform,ppd,producteng","user":"builds@netflix.com"},{"name":"Verify nts,platform,ppd,producteng","type":"wait","waitTime":86400.0,"refId":"14","user":"builds@netflix.com","requisiteStageRefIds":["13"]},{"requisiteStageRefIds":["14"],"type":"script","failPipeline":true,"waitForCompletion":true,"repoUrl":"CISYS/jenkins-spinnaker-scripts","command":"bin/update-controller.sh recommendations,sct,ui,uiplatform,vms","refId":"15","name":"Deploy recommendations,sct,ui,uiplatform,vms","user":"builds@netflix.com"},{"name":"Verify recommendations,sct,ui,uiplatform,vms","type":"wait","waitTime":86400.0,"refId":"16","user":"builds@netflix.com","requisiteStageRefIds":["15"]}],"id":"B03B0500-C475-4C73-BCB5-5057F1BB82AD","updateTs":"1547804366000"},{"keepWaitingPipelines":false,"parameterConfig":[{"description":"Name for master","name":"master_name"},{"description":"Which AZ should the master and slaves be in","hasOptions":true,"name":"availability_zone","options":[{"value":"us-west-2b"},{"value":"us-west-2c"},{"value":"us-west-2a"}]}],"spelEvaluator":"v2","lastModifiedBy":"emburns@netflix.com","index":18,"description":"Create a new master by providing a stack name.  You must create the ELB and the route53 before running the pipeline. Assumes existence of ELB named like jenkins-<master_name>.","triggers":[],"executionEngine":"v3","limitConcurrent":false,"appConfig":{},"application":"jenkins","parallel":true,"name":"west2-controller","stages":[{"refId":"2","requisiteStageRefIds":["6"],"clusters":[{"account":"build_prod","application":"jenkins","availabilityZones":{"us-west-2":["${parameters['availability_zone']}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"ebsOptimized":true,"healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":false,"instanceType":"r3.2xlarge","keyPair":"nf-keypair-453078116140-us-west-2","loadBalancers":["jenkins-${parameters['master_name']}-vpc0"],"provider":"aws","securityGroups":[],"stack":"${parameters['master_name']}","strategy":"","strategyApplication":"jenkins","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy Master","type":"deploy"},{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-${parameters['cluster']}-slave","comments":"The slave will not pass health check until the master exists.","credentials":"test","name":"Find Slave Image from Cluster","onlyEnabled":true,"refId":"3","regions":["us-west-1"],"requisiteStageRefIds":["2"],"selectionStrategy":"NEWEST","type":"findImage"},{"clusters":[{"account":"test","application":"jenkins","availabilityZones":{"us-west-1":["${parameters['availability_zone']}"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"ebsOptimized":false,"freeFormDetails":"slave","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"jenkinsInstanceProfile","instanceMonitoring":false,"instanceType":"m3.2xlarge","keyPair":"nf-test-keypair-a","loadBalancers":[],"provider":"aws","securityGroups":["sg-d00987b5","sg-d60987b3"],"stack":"${parameters['master_name']}","strategy":"highlander","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{},"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy Slave","refId":"4","requisiteStageRefIds":["3"],"type":"deploy"},{"refId":"5","requisiteStageRefIds":[],"failPipeline":true,"instructions":"Create an ELB named `jenkins-${parameters['master_name']}-vpc0`.","judgmentInputs":[{"value":"jenkins-${parameters['master_name']}-vpc0 ELB exists"}],"name":"Manual Judgment","notifications":[],"type":"manualJudgment"},{"refId":"6","requisiteStageRefIds":["5"],"type":"findImageFromTags","name":"Find Image from Tags","cloudProviderType":"aws","tags":{},"regions":["us-west-2"],"cloudProvider":"aws","packageName":"nflx-jenkins"}],"id":"1eca9025-eedd-49ee-bc33-dccbf661efa6","updateTs":"1547846704000"},{"parameterConfig":[{"description":"Name of stack to upgrade","name":"stack"},{"description":"Availability zone of volmount - cluster and volume must be in same zone","name":"avail_zone"},{"description":"EC2 instance type for cluster","name":"instance_type"}],"spelEvaluator":"v2","lastModifiedBy":"emburns@netflix.com","index":19,"description":"Called by the update action on a master.  Pulls ami from helium and creates a new instance in the cluster.","triggers":[],"executionEngine":"v3","stageCounter":3,"appConfig":{},"limitConcurrent":false,"application":"jenkins","parallel":true,"stages":[{"cloudProvider":"aws","cloudProviderType":"aws","cluster":"jenkins-helium","comments":"","credentials":"build_prod","name":"Find Image","onlyEnabled":true,"refId":"2","regions":["us-west-2"],"requisiteStageRefIds":[],"selectionStrategy":"NEWEST","type":"findImage"},{"clusters":[{"account":"build_prod","application":"jenkins","availabilityZones":{"us-west-2":["us-west-2a","us-west-2b","us-west-2c"]},"capacity":{"desired":1,"max":1,"min":1},"cloudProvider":"aws","cooldown":10,"copySourceCustomBlockDeviceMappings":false,"dirty":{},"ebsOptimized":true,"enabledMetrics":[],"freeFormDetails":"","healthCheckGracePeriod":600,"healthCheckType":"EC2","iamRole":"BaseIAMRole","instanceMonitoring":false,"instanceType":"r5.2xlarge","keyPair":"nf-keypair-453078116140-us-west-2","loadBalancers":["jenkins-${trigger.parameters.stack}-frontend"],"pipelineParameters":{},"provider":"aws","securityGroups":["sg-c9fff0b7","sg-954b66ea","sg-72416c0d"],"spelLoadBalancers":[],"spelTargetGroups":[],"spotPrice":"","stack":"${trigger.parameters.stack}","strategy":"custom","strategyApplication":"jenkins","strategyPipeline":"55a07bba-3c3d-4701-ae4c-641d59704716","subnetType":"internal (vpc0)","suspendedProcesses":["AZRebalance"],"tags":{"jenkins:controller":"${trigger.parameters.stack}"},"targetGroups":[],"targetHealthyDeployPercentage":100,"terminationPolicies":["Default"],"useAmiBlockDeviceMappings":false}],"name":"Deploy","refId":"3","requisiteStageRefIds":["2"],"type":"deploy"},{"continuePipeline":false,"failPipeline":true,"job":"ROCK-jenkins-auth-acceptance-tests","markUnstableAsSuccessful":true,"master":"opseng","name":"Jenkins","parameters":{},"refId":"4","requisiteStageRefIds":["3"],"type":"jenkins","waitForCompletion":false}],"name":"controller-update-usw2","id":"07ac88cb-2a98-4693-a475-5c87d6ec9dbc","updateTs":"1547846704000"},{"keepWaitingPipelines":false,"limitConcurrent":true,"application":"jenkins","spelEvaluator":"v2","lastModifiedBy":"emburns@netflix.com","name":"docker-agent","stages":[{"refId":"1","requisiteStageRefIds":[],"type":"deploy","name":"Deploy","clusters":[{"application":"jenkins","region":"us-east-1","network":"default","inService":true,"resources":{"cpu":2,"networkMbps":128,"disk":50000,"memory":4096,"gpu":0},"strategy":"highlander","capacity":{"min":1,"max":2,"desired":2},"env":{},"labels":{},"containerAttributes":{},"cloudProvider":"titus","iamProfile":"jenkinsInstanceProfile","softConstraints":[],"hardConstraints":[],"securityGroups":["sg-ea847c92","sg-f2f19496","sg-f0f19494"],"migrationPolicy":{"type":"systemDefault"},"registry":"testregistry","stack":"buildstest","freeFormDetails":"agent-small","useSourceCapacity":false,"provider":"titus","account":"titustestvpc","deferredInitialization":true}]}],"index":20,"id":"c32c5fb7-f6ff-4fbf-9f71-ac6c40619784","triggers":[{"enabled":true,"type":"docker","account":"testregistry","registry":"titan-registry.main.us-east-1.dyntest.netflix.net:7002","organization":"cisys","repository":"cisys/nflx-jenkins-agent-docker","tag":""}],"updateTs":"1547846704000","executionEngine":"v3"},{"keepWaitingPipelines":false,"limitConcurrent":true,"application":"jenkins","spelEvaluator":"v2","lastModifiedBy":"emburns@netflix.com","name":"Jenkins Usage","stages":[{"refId":"1","requisiteStageRefIds":[],"type":"runJob","name":"Run Job","cloudProviderType":"titus","cluster":{"env":{},"application":"jenkins","securityGroups":["sg-08076e2a99d83f491"],"resources":{"gpu":0,"cpu":4,"disk":128,"memory":2500,"networkMbps":1024},"capacity":{"min":1,"max":1,"desired":1},"runtimeLimitSecs":3600,"region":"us-west-2","imageId":"cisys/jaas-usage:stable","retries":0,"entryPoint":"/apps/jaas-usage/bin/jaas-usage"},"waitForCompletion":true,"credentials":"titusprodvpc","cloudProvider":"titus","deferredInitialization":true,"registry":"prodregistry","organization":"cisys","repository":"cisys/jaas-usage","tag":"stable","showAdvancedOptions":true}],"index":21,"id":"de8afc60-ba9e-4fa9-b5fe-4b32948951ac","triggers":[{"enabled":true,"type":"cron","id":"1fb3535a-37a5-4178-a635-af7c416b6b7b","cronExpression":"0 0 0 1/1 * ? *"}],"updateTs":"1547846704000","executionEngine":"v3"},{"keepWaitingPipelines":false,"limitConcurrent":true,"application":"jenkins","spelEvaluator":"v2","lastModifiedBy":"emburns@netflix.com","name":"engtools-jenkins-docs-nightly-build","stages":[{"refId":"1","requisiteStageRefIds":[],"type":"runJob","name":"Run Job","failPipeline":true,"continuePipeline":false,"cloudProviderType":"titus","cluster":{"capacity":{"min":1,"max":1,"desired":1},"application":"jenkins","env":{},"resources":{"cpu":1,"disk":10000,"gpu":0,"memory":512,"networkMbps":128},"retries":0,"runtimeLimitSecs":3600,"securityGroups":[],"region":"us-east-1","entryPoint":"metatron curl -X POST \"https://arcas.test.netflix.net/api/v1/hosts/stash/owners/ENGTOOLS/repos/jenkins-docs/launchBranch?username=nightly-build-spinnaker-triggered&email=buildtools%40netflix.com\" -H \"accept: application/json\"","imageId":"spinnaker/basic:latest"},"waitForCompletion":true,"credentials":"titusprodvpc","cloudProvider":"titus","deferredInitialization":true,"registry":"prodregistry","organization":"spinnaker","repository":"spinnaker/basic","tag":"latest","region":"us-east-1","account":"titusprodvpc"}],"index":22,"id":"b809264c-42e2-437e-a9a8-6a5a65558b60","triggers":[{"enabled":true,"type":"cron","id":"e8e2fad4-9734-49df-a786-caa570f456d8","cronExpression":"0 0 0 1/1 * ? *"}],"updateTs":"1547846705000","executionEngine":"v3"},{"keepWaitingPipelines":false,"limitConcurrent":true,"application":"jenkins","spelEvaluator":"v2","lastModifiedBy":"emburns@netflix.com","name":"test","stages":[],"index":23,"id":"13860fe0-03cd-4ef6-81b9-ff1694c66c1b","triggers":[],"updateTs":"1547846706000","executionEngine":"v3"}]
