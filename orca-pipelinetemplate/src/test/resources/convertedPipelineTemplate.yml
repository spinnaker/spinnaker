# GENERATED BY spinnaker
#
# The template generated below should be used as a base for further modifications.
# It does not make assumptions as to what things can be made into variables,
# modules, partials or Jinja expressions. This is your responsibility as the owner
# of the template.
#
# Some recommendations to massage the initial output:
#
# * Give your pipeline template a unique ID. It's best to namespace it by your
#   application or team name, so that it does not conflict with other teams,
#   e.g. "myteam-myTemplate".
# * Rename the pipeline stage IDs, notifications and trigger names to be more
#   meaningful. Enumerated stage IDs are ultimately a detriment for long-term
#   maintenance of your template.
# * Best intentions are made to order configuration, but the list of stages
#   themselves are not ordered: Rearrange the stages so that they're roughly
#   chronological.
schema: '1'
id: spinnaker-generatedTemplate
metadata:
  name: GIVE ME A NAME
  description: This is my favorite pipeline!
  owner: example@example.com
  scopes: []
protect: false
configuration:
  concurrentExecutions:
    limitConcurrent: true
  triggers:
  - enabled: false
    job: ZZ-demo
    master: myMaster
    name: unnamed0
    type: jenkins
  - cronExpression: 0 0/12 * * * ?
    enabled: true
    id: b2ba0819-dbe5-42bd-a8b0-0499c131711f
    name: unnamed1
    type: cron
  expectedArtifacts:
  - defaultArtifact:
      kind: custom
    id: abcd
    matchArtifact:
      kind: custom
      type: jenkins/job
      name: MyJenkinsJob
    useDefaultArtifact: false
    usePriorExecution: false
  parameters: []
  notifications:
  - address: example@example.com
    level: pipeline
    name: email0
    type: email
    when:
    - pipeline.failed
variables: []
stages:
- id: bake1
  type: bake
  dependsOn: []
  name: Bake
  config:
    baseLabel: release
    baseOs: trusty
    cloudProviderType: aws
    enhancedNetworking: false
    extendedAttributes: {}
    overrideTimeout: true
    package: orca
    regions:
    - us-east-1
    - us-west-1
    - us-west-2
    - eu-west-1
    sendNotifications: true
    showAdvancedOptions: true
    stageTimeoutMs: 900000
    storeType: ebs
    user: example@example.com
    vmType: hvm
- id: deploy2
  type: deploy
  dependsOn:
  - bake1
  name: Deploy
  config:
    clusters:
    - account: test
      application: spindemo
      availabilityZones:
        us-west-1:
        - us-west-1a
        - us-west-1c
      capacity:
        desired: 1
        max: 1
        min: 1
      cloudProvider: aws
      cooldown: 10
      copySourceCustomBlockDeviceMappings: true
      ebsOptimized: false
      enabledMetrics: []
      freeFormDetails: demo
      healthCheckGracePeriod: 600
      healthCheckType: EC2
      iamRole: myIAMRole
      instanceMonitoring: false
      instanceType: m3.large
      interestingHealthProviderNames:
      - Amazon
      keyPair: keypair
      loadBalancers:
      - spindemo-demo-frontend
      maxRemainingAsgs: 2
      preferSourceCapacity: true
      provider: aws
      scaleDown: true
      securityGroups: []
      stack: test
      strategy: redblack
      subnetType: mySubnet
      suspendedProcesses: []
      tags: {}
      targetGroups: []
      targetHealthyDeployPercentage: 100
      terminationPolicies:
      - Default
      useAmiBlockDeviceMappings: false
      useSourceCapacity: true
    - account: test
      application: spindemo
      availabilityZones:
        us-east-1:
        - us-east-1c
        - us-east-1d
        - us-east-1e
      capacity:
        desired: 0
        max: 0
        min: 0
      cloudProvider: aws
      cooldown: 10
      ebsOptimized: false
      freeFormDetails: demo
      healthCheckGracePeriod: 600
      healthCheckType: EC2
      iamRole: myIAMRole
      instanceMonitoring: false
      instanceType: m3.large
      interestingHealthProviderNames:
      - Amazon
      keyPair: keypair
      provider: aws
      securityGroups: []
      stack: test
      strategy: highlander
      subnetType: mySubnet
      suspendedProcesses: []
      tags: {}
      targetHealthyDeployPercentage: 100
      terminationPolicies:
      - Default
      useSourceCapacity: false
- id: checkPreconditions6
  type: checkPreconditions
  dependsOn:
  - wait8
  name: Check Preconditions (us-west-1)
  config:
    preconditions:
    - context:
        cluster: spindemo-test-demo
        comparison: <=
        credentials: test
        expected: 2
        regions:
        - us-west-1
      failPipeline: true
      type: clusterSize
- id: checkPreconditions7
  type: checkPreconditions
  dependsOn:
  - wait8
  name: Check Preconditions (us-east-1)
  config:
    completeOtherBranchesThenFail: false
    continuePipeline: false
    failPipeline: true
    preconditions:
    - context:
        cluster: spindemo-test-demo
        comparison: ==
        credentials: test
        expected: 1
        regions:
        - us-east-1
      failPipeline: true
      type: clusterSize
- id: wait8
  type: wait
  dependsOn:
  - deploy2
  name: Wait
  config:
    comments: Wait 2 min for the clusters to normalize before the precondition asg size checks
    waitTime: 120
